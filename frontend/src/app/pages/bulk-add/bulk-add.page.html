<section class="page">
  <header class="pageHeader">
    <a class="link" routerLink="/entries">Back</a>
    <h1>Bulk add</h1>
  </header>

  <p class="muted">
    Paste one URL per line, or pairs of Title and URL. We’ll create entries and queue
    enrichment/thumbnail jobs.
  </p>

  <textarea
    class="textArea"
    rows="12"
    [value]="raw()"
    (input)="raw.set(($any($event.target).value ?? '').toString())"
    placeholder="Title (optional)&#10;https://example.com/&#10;&#10;https://www.youtube.com/watch?v=...&#10;..."
  ></textarea>

  <div class="actions">
    <button
      class="button"
      type="button"
      (click)="submit()"
      [disabled]="saving() || parsedItems().length === 0"
    >
      Add {{ parsedItems().length }} item(s)
    </button>
    @if (saving()) {
      <span class="muted">Queuing…</span>
    }
  </div>

  @if (result()) {
    <div class="resultBox">
      <div><b>Created</b>: {{ result()!.createdCount }}</div>
      <div><b>Skipped</b>: {{ result()!.skippedCount }}</div>
      @if ((result()?.errors?.length ?? 0) > 0) {
        <div class="errListTitle">Errors:</div>
        <ul class="errList">
          @for (e of result()?.errors ?? []; track e.url) {
            <li>
              <b>{{ e.url }}</b> — {{ e.error }}
            </li>
          }
        </ul>
      }
    </div>
  }

  @if (error()) {
    <div class="errorBox">{{ error() }}</div>
  }
</section>
